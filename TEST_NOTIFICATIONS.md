# ๐งช ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงูุฎุงุฑุฌูุฉ

## โ ุงููุถุน ุงูุญุงูู

- โ ุงูุณูุฑูุฑ: Firebase Admin initialized
- โ `google-services.json` ููุฌูุฏ
- โ ุงูููุฏ ุฌุงูุฒ ูู ุงูุชุทุจูู

---

## ๐ฑ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### 1. ุดุบูู ุงูุชุทุจูู ูุณุฌูู ุงูุฏุฎูู

1. ุงูุชุญ ุงูุชุทุจูู ุนูู ุฌูุงุฒ Android
2. ุณุฌูู ุงูุฏุฎูู (ููุณุชุฎุฏู ุฃู ุณุงุฆู)
3. ุชุญูู ูู **Logs ูู ุงูุชุทุจูู** - ูุฌุจ ุฃู ุชุฑู:

```
โ Firebase initialized
โ FirebaseMessagingService initialized
โ FCM Token obtained: ...
โ FCM Token sent to server for user/driver: ...
```

### 2. ุชุญูู ูู ุฃู FCM Token ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

- ุฅุฐุง ููุช ุชุณุชุฎุฏู MongoDB Compass ุฃู ุฃู ุฃุฏุงุฉ ุฃุฎุฑู:
  - ุงูุชุญ collection `users` ุฃู `drivers`
  - ุงุจุญุซ ุนู ุงููุณุชุฎุฏู/ุงูุณุงุฆู ุงูุฐู ุณุฌูู ุงูุฏุฎูู
  - ุชุญูู ูู ุฃู ุญูู `fcmToken` ููุฌูุฏ ูููุณ `null`

### 3. ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช

#### ุงูุทุฑููุฉ 1: ูู Firebase Console (ุงูุฃุณูู)

1. ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com)
2. ุงุฎุชุฑ ูุดุฑูุนู: `munqethnof`
3. ุงุฐูุจ ุฅูู **Cloud Messaging** (ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ)
4. ุงุถุบุท **"Send test message"**
5. ุฃุฏุฎู **FCM Token** (ููููู ุงูุญุตูู ุนููู ูู Logs ูู ุงูุชุทุจูู)
6. ุฃุฏุฎู:
   - **Title:** "ุงุฎุชุจุงุฑ"
   - **Text:** "ูุฐุง ุฅุดุนุงุฑ ุชุฌุฑูุจู"
7. ุงุถุบุท **"Test"**
8. **ุฃุบูู ุงูุชุทุจูู ุชูุงูุงู** (ูุง ููุท ูู ุงูุฎูููุฉ)
9. ูุฌุจ ุฃู ุชุตู ุงูุฅุดุนุงุฑ ุญุชู ูู ูุงู ุงูุชุทุจูู ูุบูู

#### ุงูุทุฑููุฉ 2: ูู ุงูุณูุฑูุฑ (ุนูุฏ ุฅูุดุงุก ุทูุจ)

1. ุฃูุดุฆ ุทูุจ ุฌุฏูุฏ ูู ุงูุชุทุจูู (ููุณุชุฎุฏู)
2. ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ููุณุงุฆู
3. ุนูุฏูุง ููุจู ุงูุณุงุฆู ุงูุทูุจุ ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ููุฒุจูู
4. ุนูุฏูุง ูุชุบูุฑ ุญุงูุฉ ุงูุทูุจุ ูุฌุจ ุฃู ุชุตู ุฅุดุนุงุฑุงุช

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ุฃุฑู "FCM Token obtained" ูู Logs

**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู `google-services.json` ููุฌูุฏ ูู `android/app/`
- ุชุฃูุฏ ูู ุฃู ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ุชู ููุญูุง
- ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู

### ุงููุดููุฉ: "FCM Token sent to server failed"

**ุงูุญู:**
- ุชุญูู ูู ุฃู ุงูุณูุฑูุฑ ูุนูู
- ุชุญูู ูู ุฃู API endpoint ูุนูู (`/users/phone/{phone}/fcm-token` ุฃู `/drivers/driverId/{driverId}/fcm-token`)
- ุชุญูู ูู Logs ูู ุงูุณูุฑูุฑ

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุตู ูู Firebase Console

**ุงูุญู:**
- ุชุญูู ูู ุฃู FCM Token ุตุญูุญ (ุงูุณุฎู ูู Logs)
- ุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ููุซุจุช ุนูู ุงูุฌูุงุฒ (ููุณ ููุท ูู Emulator)
- ุชุฃูุฏ ูู ุฃู ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ููุนูุฉ

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ุชุตู ููุท ุนูุฏูุง ูููู ุงูุชุทุจูู ููุชูุญ

**ุงูุญู:**
- ูุฐุง ุทุจูุนู ุฅุฐุง ูุงู ุงูุฅุดุนุงุฑ ูู ููุน `data-only` (ุจุฏูู `notification` payload)
- ููุชุฃูุฏ ูู ุฃู ุงูุฅุดุนุงุฑุงุช ุชุตู ุนูุฏ ุฅุบูุงู ุงูุชุทุจููุ ุงุณุชุฎุฏู Firebase Console ูุงุฎุชุฑ "Send test message" (ุณูุฑุณู notification payload)

---

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุงูุชุทุจูู ูุนูู
- [ ] ุชู ุชุณุฌูู ุงูุฏุฎูู (ููุณุชุฎุฏู ุฃู ุณุงุฆู)
- [ ] Logs ุชุธูุฑ "FCM Token obtained"
- [ ] Logs ุชุธูุฑ "FCM Token sent to server"
- [ ] FCM Token ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑ ูู Firebase Console
- [ ] ุงูุฅุดุนุงุฑ ูุตู ุญุชู ุนูุฏูุง ูุงู ุงูุชุทุจูู ูุบูู

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุฅุบูุงู ุงูุชุทุจูู:**
   - Firebase ูุนุฑุถ ุงูุฅุดุนุงุฑ ุชููุงุฆูุงู ุฅุฐุง ูุงู ูุญุชูู ุนูู `notification` payload (title + body)
   - ุฅุฐุง ูุงู ุงูุฅุดุนุงุฑ `data-only` (ุจุฏูู notification payload)ุ ุณูุญุชุงุฌ ุงูุชุทุจูู ุฃู ูููู ููุชูุญุงู ุฃู ูู ุงูุฎูููุฉ

2. **FCM Token ูุชุบูุฑ:**
   - ุนูุฏ ุฅุนุงุฏุฉ ุชุซุจูุช ุงูุชุทุจูู
   - ุนูุฏ ุชุญุฏูุซ ุงูุชุทุจูู
   - ุฃุญูุงูุงู ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู ุนูู ุฌูุงุฒ ุฌุฏูุฏ
   - ูุชู ุงูุชุนุงูู ูุน ูุฐุง ุชููุงุฆูุงู ุนุจุฑ `onTokenRefresh`

3. **ููุงุฎุชุจุงุฑ ุนูู Emulator:**
   - Google Play Services ูุฌุจ ุฃู ูููู ูุซุจุชุงู
   - ุฃู ุงุณุชุฎุฏู ุฌูุงุฒ ุญูููู (ุฃูุถู ููุงุฎุชุจุงุฑ)

---

**ุจุนุฏ ุงูุชุญูู ูู ูู ูุฐู ุงูููุงุทุ ุงูุฅุดุนุงุฑุงุช ูุฌุจ ุฃู ุชุนูู ุจุดูู ุตุญูุญ! ๐**

